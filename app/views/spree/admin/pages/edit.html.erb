<% content_for :head do %>
  <%# TODO: Load CSS assets from CDN/URL %>
  <%= stylesheet_link_tag 'alchemy/backend' %>
  <%# TODO: Load JS assets from CDN/URL %>
  <%= javascript_include_tag 'alchemy/backend' %>
  <script>
    // TODO: Move host config into Alchemy::Solidus::Config
    Alchemy.Routes.host = 'http://localhost:4000';
  </script>
  <%# TODO: Find solution for setting up tinymce %>
  <%= render 'alchemy/admin/partials/tinymce_init' %>
<% end %>

<% content_for :page_actions do %>
  <li>
    <button class="btn btn-primary alchemy-reload-button with-tip fa fa-refresh" title="Reload preview">
    </button>
  </li>
  <li>
    <button class="btn btn-primary alchemy-expand-button with-tip fa fa-expand" title="Expand preview">
    </button>
  </li>
<% end %>

<% admin_breadcrumb(link_to plural_resource_name(Spree::Product), spree.admin_products_path) %>
<% admin_breadcrumb(link_to @product.name, spree.admin_product_path(@product)) %>
<% admin_breadcrumb('Page') %>

<%# TODO: Find solution for setting up custom tinymce config %>
<% if Alchemy::Tinymce.custom_config_contents(@product.alchemy_page).present? %>
  <%= render 'tinymce_custom_config' %>
<% end %>

<%# TODO: Find solution for locale data loading %>
<%= render 'alchemy/admin/partials/locale_data' %>

<script>
  $(function() {
    Alchemy.ElementsWindow = new Alchemy.Views.ElementsWindow(
      <%= @product.product_page.page_id %>, {
        container: 'body',
        top_menu_height: $('#content-header').outerHeight(),
        element_window_button: '.alchemy-expand-button'
      }
    );
    Alchemy.PreviewWindow = new Alchemy.Views.PreviewWindow(
      '<%= spree.product_path(id: @product.slug) %>', {
        main_menu_width: $('.admin-nav').outerWidth(),
        reload_button: '.alchemy-reload-button'
      }
    );
  });
</script>
